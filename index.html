<!DOCTYPE html><html lang="en"><head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KukuSoko Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head><body class="bg-gray-50 min-h-screen font-sans">
  <header class="bg-white shadow-md p-4 flex justify-between items-center">
    <div class="flex items-center space-x-4">
      <img src="logo.png" alt="KukuSoko Logo" class="h-16 w-16" />
      <h1 class="text-2xl font-bold text-green-700">KukuSoko</h1>
    </div>
    <div>
      <select id="languageSelect" class="border rounded px-2 py-1">
        <option value="en">English</option>
        <option value="sw">Kiswahili</option>
      </select>
    </div>
  </header>  <main class="max-w-4xl mx-auto p-4">
    <section class="mb-6">
      <h2 class="text-xl font-semibold mb-2" id="formTitle">Register Farmer</h2>
      <form id="farmerForm" class="space-y-4">
        <input type="text" id="name" placeholder="Farmer Name" required class="w-full border p-2 rounded" />
        <input type="text" id="location" placeholder="Location" required class="w-full border p-2 rounded" />
        <input type="text" id="contact" placeholder="Phone Number" required class="w-full border p-2 rounded" />
        <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Submit</button>
      </form>
    </section><section class="mb-4">
  <input type="text" id="searchInput" placeholder="Search Farmers..." class="w-full p-2 border rounded mb-4" />
  <div class="mb-4 text-gray-700" id="dashboardStats">Loading stats...</div>
  <table class="min-w-full bg-white shadow-md rounded">
    <thead class="bg-green-600 text-white">
      <tr>
        <th class="py-2 px-4 text-left">Name</th>
        <th class="py-2 px-4 text-left">Location</th>
        <th class="py-2 px-4 text-left">Contact</th>
        <th class="py-2 px-4 text-left">Action</th>
      </tr>
    </thead>
    <tbody id="farmerTable" class="divide-y divide-gray-200"></tbody>
  </table>
</section>

  </main>  <script>
    const translations = {
      en: {
        register: "Register Farmer",
        submit: "Submit",
        search: "Search Farmers...",
        stats: (count) => `Total Farmers: ${count}`,
        delete: "Delete"
      },
      sw: {
        register: "Sajili Mkulima",
        submit: "Tuma",
        search: "Tafuta Wakulima...",
        stats: (count) => `Wakulima Jumla: ${count}`,
        delete: "Futa"
      }
    };

    const firebaseConfig = {
      apiKey: "AIzaSyDZJ52pOpM4EJjZfRNSLCn2Or9VFsTEfrA",
      authDomain: "kukusoko.firebaseapp.com",
      projectId: "kukusoko",
      storageBucket: "kukusoko.appspot.com",
      messagingSenderId: "854606179651",
      appId: "1:854606179651:web:9742df9941cc66536e93f6",
      measurementId: "G-WW0DHDR43N"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const form = document.getElementById("farmerForm");
    const table = document.getElementById("farmerTable");
    const searchInput = document.getElementById("searchInput");
    const stats = document.getElementById("dashboardStats");
    const langSelect = document.getElementById("languageSelect");
    let currentLang = 'en';

    function translateUI() {
      document.getElementById("formTitle").innerText = translations[currentLang].register;
      form.querySelector("button").innerText = translations[currentLang].submit;
      searchInput.placeholder = translations[currentLang].search;
      updateStatsUI();
    }

    function updateStatsUI(count = 0) {
      stats.innerText = translations[currentLang].stats(count);
    }

    async function loadFarmers() {
      const snapshot = await db.collection("farmers").orderBy("createdAt", "desc").get();
      const farmers = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
      displayFarmers(farmers);
      updateStatsUI(farmers.length);
    }

    function displayFarmers(farmers) {
      table.innerHTML = "";
      const search = searchInput.value.toLowerCase();
      farmers.filter(f => f.name.toLowerCase().includes(search)).forEach(farmer => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td class="py-2 px-4">${farmer.name}</td>
          <td class="py-2 px-4">${farmer.location}</td>
          <td class="py-2 px-4">${farmer.contact}</td>
          <td class="py-2 px-4">
            <button onclick="deleteFarmer('${farmer.id}')" class="bg-red-500 text-white px-2 py-1 rounded">${translations[currentLang].delete}</button>
          </td>`;
        table.appendChild(row);
      });
    }

    async function deleteFarmer(id) {
      await db.collection("farmers").doc(id).delete();
      loadFarmers();
    }

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const name = document.getElementById("name").value;
      const location = document.getElementById("location").value;
      const contact = document.getElementById("contact").value;

      await db.collection("farmers").add({ name, location, contact, createdAt: new Date() });
      form.reset();
      loadFarmers();
    });

    searchInput.addEventListener("input", loadFarmers);
    langSelect.addEventListener("change", (e) => {
      currentLang = e.target.value;
      translateUI();
      loadFarmers();
    });

    translateUI();
    loadFarmers();
  </script></body></html>
