<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>KukuSoko Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 text-gray-800 p-4 font-sans">
  <div class="max-w-4xl mx-auto">
    <div class="text-center mb-8">
      <img src="logo.png" alt="KukuSoko Logo" class="mx-auto h-24">
      <h1 class="text-3xl font-bold">KukuSoko Dashboard</h1>
      <p class="text-gray-600">Simple aggregation tool for poultry collection</p>
    </div><section class="mb-6">
  <h2 class="text-lg font-semibold mb-2">âž• Sajili Mkulima Mpya</h2>
  <form id="farmerForm" class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <input type="text" id="name" placeholder="Jina" required class="border p-2 rounded">
    <input type="text" id="phone" placeholder="Nambari ya Simu" required class="border p-2 rounded">
    <input type="text" id="location" placeholder="Eneo" required class="border p-2 rounded">
    <button type="submit" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Sajili</button>
  </form>
</section>

<section class="mb-6">
  <h2 class="text-lg font-semibold mb-2">ðŸ‘¥ Wakulima Wote (All Farmers)</h2>
  <div class="overflow-auto max-w-full">
    <table class="min-w-full bg-white rounded shadow">
      <thead>
        <tr class="bg-gray-200 text-left">
          <th class="p-2">Jina</th>
          <th class="p-2">Simu</th>
          <th class="p-2">Eneo</th>
          <th class="p-2">Tarehe</th>
        </tr>
      </thead>
      <tbody id="farmerTable" class="text-sm"></tbody>
    </table>
  </div>
</section>

<section>
  <h2 class="text-lg font-semibold mb-2">ðŸ“Š Muhtasari (Summary)</h2>
  <div id="summary" class="p-4 bg-white rounded shadow">
    <p>Total Farmers: <span id="farmerCount">0</span></p>
  </div>
</section>

  </div>  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js";
// Firebase configuration for Kukusoko
const firebaseConfig = {
  apiKey: "AIzaSyDZJ52pOpM4EJjZfRNSLCn2Or9VFsTEfrA",
  authDomain: "kukusoko.firebaseapp.com",
  projectId: "kukusoko",
  storageBucket: "kukusoko.firebasestorage.app",
  messagingSenderId: "854606179651",
  appId: "1:854606179651:web:9742df9941cc66536e93f6",
  measurementId: "G-WW0DHDR43N"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const farmerForm = document.getElementById('farmerForm');
    const farmerCount = document.getElementById('farmerCount');

    farmerForm.addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;
      const location = document.getElementById('location').value;

      await addDoc(collection(db, 'farmers'), {
        name,
        phone,
        location,
        created: serverTimestamp()
      });

      farmerForm.reset();
      updateSummary();
      loadFarmers();
    });

    async function updateSummary() {
      const querySnapshot = await getDocs(collection(db, 'farmers'));
      farmerCount.textContent = querySnapshot.size;
    }

    async function loadFarmers() {
      const snapshot = await getDocs(query(collection(db, 'farmers'), orderBy('created', 'desc')));
      const tbody = document.getElementById('farmerTable');
      tbody.innerHTML = '';

      snapshot.forEach(doc => {
        const data = doc.data();
        const row = document.createElement('tr');
        row.innerHTML = `
          <td class="p-2">${data.name}</td>
          <td class="p-2">${data.phone}</td>
          <td class="p-2">${data.location}</td>
          <td class="p-2">${data.created?.toDate().toLocaleDateString() || '-'}</td>
        `;
        tbody.appendChild(row);
      });
    }

    updateSummary();
    loadFarmers();
  </script></body>
</html>
